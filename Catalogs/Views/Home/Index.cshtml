<br/>

<div class="j-main-container">
    @Html.Action("Catalogs")
</div>

@section scripts{
    <script>
        (function ($) {
            var fieldSl = '.j-field', $container = $('.j-main-container');

            $('.j-catalog-list').click(function (e) {
                e.preventDefault();
                $.ajax('@Url.Action("Catalogs")').done(function(resp) {
                    $container.html(resp);
                });
            });

            $container.on('click', '.j-add-catalog', function() {
                $.ajax('@Url.Action("Add")').done(function(resp) {
                    $container.html(resp);
                });
            });

            $container.on('click', 'button[data-catalogid]', function() {
                    var $this = $(this),
                        catalogId = $this.data('catalogid');
                    var selector = '[data-catalogid="' + catalogId + '"]';
                    $('tr' + selector).toggleClass('hidden');
                }
            );

            $container.on('click', '.j-add-field', function () {
                var $last = lastField();
                $last.clone().insertAfter($last);
                lastField().find('input').val('');
            });

            $container.on('click',
                '.j-remove-field',
                function() {
                    if ($(fieldSl).length > 1)
                        $(this).closest('tr').remove();
                });

            function lastField() { return $(fieldSl).last(); };
        })(jQuery);
    </script>
}

